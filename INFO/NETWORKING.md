# NETWORKING OBSERVATIONS 

## Prefix

I use "container" & "actions container" synonmously here - I'm also speaking about containers in the context of unix environments and their intrepretation by the kernel. A namespace is a partioned set of resources, capabilities, and devices(drivers). Each namespace, and the underlying resources it has access to, is mapped by the kernel to a set processes, user a group IDs that maintain tenancy over those resources. 

### The high-level to understand about network namepsaces:
  1. Network namespaces virtualize the network stack. On creation a network namespace contains only a loopback interface.
  2. Each network interface (physical or virtual) is present in exactly 1 namespace and can be moved between namespaces.
  3. Each namespace will have a private set of IP addresses, its own routing table, socket listing, connection tracking table, firewall, and other network-related resources.
  4. Destroying a network namespace destroys any virtual interfaces within it and moves any physical interfaces within it back to the initial network namespace.

- - -

## Github Actions

The network in gh actions is, at it's core, quite a standard setup. Each container is in it's own network namespace; by default three network interfaces are attached, their configuration is as follows:

A loopback interface "lo" is on 127.0.0.1/8, it's likely this is reflecting to the orchestrator of this container. The orchestrator could be running on the same physical host or accesible over a network. Regardless, both the compute resources are both given virutal interfaces asigned with respect to [rfc191](https://datatracker.ietf.org/doc/html/rfc1918#section-3). Github has only used a 256bit netmask though, so we see containers themselves under `10.1.0.0/16` and docker on `172.17.0.1/16`. Note that the docker interface is `DOWN` by default (boy people really like docker, you gave it the whole interface!). 

  > Side note: What's on the rest of the availabe `8` bytes of both networks?

Okay so all standard, blah blah, but hey wait up, it get's interesting.

Each container connects to a _static amount_ of public facing ipv4 addresses; by _amount_ I mean that there are 18 connections established to public ipv4 address on almost every container.

Take a look at [tcp.patch](tcp.patch), it may as well be any other one for our sake as the same number of addresses completly change a constant subset of their parameteres between each containers executiong. 

Here's a snippet I'd like to go over
```patch
@@ -1,108 +1,118 @@
 {
   "fields": [],
   "results": [
+    {
+      "dst": "209.222.17.24",
+      "age": 173.852,
+      "source": "10.1.0.215"
+    },
     {
       "dst": "91.189.92.19",
-      "age": 128.872,
-      "source": "10.1.0.184"
+      "age": 296.848,
+      "source": "10.1.0.215"
     },
     {
-      "dst": "52.225.136.36",
-      "age": 131.352,
+      "dst": "91.189.91.42",
+      "age": 282.94,
       "cwnd": 10,
-      "rtt": 0.003374,
-      "rttvar": 0.003374,
-      "source": "10.1.0.184"
+      "rtt": 0.042476,
+      "rttvar": 0.042476,
+      "source": "10.1.0.215"
     },
     {
-      "dst": "140.82.113.9",
-      "age": 13.556,
+      "dst": "40.119.46.219",
+      "age": 18.208,
       "cwnd": 10,
-      "rtt": 0.005528,
-      "rttvar": 0.005528,
-      "source": "10.1.0.184"
+      "rtt": 0.001059,
+      "rttvar": 0.001059,
+      "source": "10.1.0.215"
     },
```

Does anything stand out about `rtt`, `rrtvar`, and `age`?

If you were looking for the `orchestrator` of the current container you occupy, where would you start given these four?

I think it's reasonable to say that this is at least a good starting point
```patch
     {
       "dst": "91.189.92.19",
-      "age": 128.872,
-      "source": "10.1.0.184"
+      "age": 296.848,
+      "source": "10.1.0.215"
     },
```

With a significant age & a `dst` despite the private `ipv4` reassignment of seperate container execution we can see that we're likely on the same physical machine, as, at least our previous run.

Now lets get a more concise picture
```bash
209.222.17.24 age 712.836sec source 10.1.0.215
91.189.92.19 age 835.832sec source 10.1.0.215
45.33.13.8 age 439.556sec cwnd 93 rtt 10782us rttvar 10782us source 10.1.0.215
91.189.91.42 age 821.924sec cwnd 10 rtt 42476us rttvar 42476us source 10.1.0.215
40.119.46.219 age 557.192sec cwnd 10 rtt 1059us rttvar 1059us source 10.1.0.215
69.164.206.178 age 439.544sec cwnd 10 rtt 18705us rttvar 11118us source 10.1.0.215
168.63.129.16 age 0.636sec cwnd 34 rtt 539us rttvar 289us source 10.1.0.215
52.239.159.84 age 837.528sec cwnd 10 rtt 1834us rttvar 1834us source 10.1.0.215
140.82.114.9 age 776.292sec cwnd 10 rtt 36689us rttvar 36689us source 10.1.0.215
204.27.63.173 age 774.464sec source 10.1.0.215
13.107.42.16 age 833.100sec source 10.1.0.215
104.214.40.16 age 837.328sec cwnd 10 rtt 6847us rttvar 11415us source 10.1.0.215
169.254.169.254 age 56.880sec cwnd 10 rtt 1237us rttvar 1754us source 10.1.0.215
20.60.48.36 age 6.652sec cwnd 10 rtt 1669us rttvar 1214us source 10.1.0.215
20.150.70.228 age 837.440sec cwnd 10 rtt 5255us rttvar 8941us source 10.1.0.215
140.82.114.4 age 774.576sec cwnd 10 rtt 41941us rttvar 41941us source 10.1.0.215
140.82.113.6 age 776.292sec cwnd 10 rtt 43549us rttvar 43549us source 10.1.0.215
91.189.92.40 age 827.676sec source 10.1.0.215
```

