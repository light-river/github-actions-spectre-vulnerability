## Speculative Store Bypass

### Thoery

Github actions VM/container runtime is vulnerable to a type of side-channel attack known as a [Speculative Store Bypass](https://en.wikipedia.org/wiki/Speculative_Store_Bypass) or SSB for short. Specifically, they are vulnerable to that attacks described in [CVE-2018-3640](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-3640) and [CVE-2018-3639](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-3640).


### Discovery

While creating iterative patches from a myriad of information about the actions kernel I noticed that  `/proc/self/status` & `/proc/$$/status` both contain: 
```
Speculation_Store_Bypass:	vulnerable
```
And the type of intel CPUs used were of the vulnerable class:
```
brand = "Intel(R) Xeon(R) CPU E5-2673 v4 @ 2.30GHz"
```
Additionally, the extended feature flags show that the SSB protections are not enabled
```
   extended feature flags (7):
	...
	SSBD: speculative store bypass disable   = false
	...
```

See [.overlay/status.proc.self](.overlay/status.proc.self) & [.overlay/cpu.stats](.overlay/cpu.stats).


### Further confirmation

So with all this in mind & decided to check for any scripts that are focused on finding these vulnerabilities, quick search and I find the [spectre-meltdown-checker](https://github.com/speed47/spectre-meltdown-checker). 

Okay, so I set up a reverse shell in a github actions host & ran their script and...

```bash
CVE-2018-3640 aka 'Variant 3a, rogue system register read'
	* CPU microcode mitigates the vulnerability:  NO 
> STATUS:  VULNERABLE
  
CVE-2018-3639 aka 'Variant 4, speculative store bypass'
		* Mitigated according to the /sys interface:  NO  (Vulnerable)
		* Kernel supports disabling speculative store bypass (SSB):  YES  (found in /proc/self/status)
		* SSB mitigation is enabled and active:  NO 
> STATUS:  VULNERABLE
```
The script states a vulnerability to the same two CVEs I was concerned about. Note that out of the 15 CVEs that it checks for, only these two were found to be vulnerabilities:
```bash
> SUMMARY: 
	CVE-2017-5753   ->   OK 
	CVE-2017-5715   ->   OK 
	CVE-2017-5754   ->   OK 
	CVE-2018-3640   ->   KO 
	CVE-2018-3639   ->   KO 
	CVE-2018-3615   ->   OK 
	CVE-2018-3620   ->   OK 
	CVE-2018-3646   ->   OK 
	CVE-2018-12126  ->   OK 
	CVE-2018-12130  ->   OK 
	CVE-2018-12127  ->   OK 
	CVE-2019-11091  ->   OK 
	CVE-2019-11135  ->   OK 
	CVE-2018-12207  ->   OK 
	CVE-2020-0543   ->   OK
```
