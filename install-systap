#!/bin/bash
kernel_v="$(uname -r)"

function add_repo_config
{
sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C8CAB6595FDFF622 
codename=$(lsb_release -c | awk  '{print $2}')
sudo tee /etc/apt/sources.list.d/ddebs.list << EOF
deb http://ddebs.ubuntu.com/ ${codename}      main restricted universe multiverse
deb http://ddebs.ubuntu.com/ ${codename}-security main restricted universe multiverse
deb http://ddebs.ubuntu.com/ ${codename}-updates  main restricted universe multiverse
deb http://ddebs.ubuntu.com/ ${codename}-proposed main restricted universe multiverse
EOF
# sudo cat /etc/apt/sources.list.d/ddebs.list | sudo tee -a /etc/apt/sources.list 
sudo apt-get update
sudo apt-get install linux-image-$(uname -r)-dbgsym
sudo apt update && sudo apt upgrade 
sudo apt-get install -y systemtap gcc
}

function build_kernel_debug_info
{
cd $HOME
sudo apt-get install dpkg-dev debhelper gawk
mkdir tmp
cd tmp
sudo apt-get build-dep --no-install-recommends linux-image-$(uname -r)
sudo apt-get source linux-image-$(uname -r)
cd linux-2.6.31
}


function add_user_groups
{
sudo groupadd -r stapusr
sudo groupadd -r stapdev
sudo groupadd -r stapsys
sudo usermod -aG stapusr $USER
sudo usermod -aG stapdev $USER
sudo usermod -aG stapsys $USER
}

add_repo_config
